<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <base th:href="${#request.getContextPath()}+'/'">

    <head>
        <meta charset="UTF-8">
        <title>数据同步实时监控</title>
        <link rel="stylesheet" type="text/css" href="css/monitor.css" />
    </head>

<body>
    <span id="bugBtn" title="同步过程出现错误数据，请检查" onclick="hideBugBtn('')"></span>
    <span id="localtime" style=" font-size:14px; position: absolute; z-index: 10; right: 25px; top:5px; "></span>
    <span class="btn btn-blue btn-big" id="refreshBtn" title="默认 1min 刷新一次">刷新</span>
    <div style="height: 620px;">
        <header class="t_header">
            <span>数据同步实时监控</span>
        </header>
        <div style="margin-top: 20px;">
            <div class="t_left_box">
                <img class="t_l_line" src="images/left_line.png" alt="">
                <div class="t_mbox">
                    <div>今日已同步</div>
                    <span id="todaySyncSpan">3658742</span>
                    <i></i>
                </div>
                <div class="t_mbox">
                    <div>待同步</div>
                    <span id="todayNoSyncSpan">152</span>
                    <i></i>
                </div>
                <div class="t_mbox">
                    <div>同步延时(秒)</div>
                    <span id="syncDelaySpan">0.5</span>
                    <i></i>
                </div>
                <div class="t_mbox">
                    <div>状态</div>
                    <span id="syncStateSpan">正常</span>
                </div>
                <img class="t_r_line" src="images/right_line.png" alt="">
            </div>
            <div class="t_top_box">
                <img class="t_l_line" src="images/left_line.png" alt="">
                <ul class="t_nav">
                    <li>
                        <span>新增</span>
                        <span id="addTj">3 ms</span>
                        <i></i>
                    </li>
                    <li>
                        <span>修改</span>
                        <span id="updateTj">5 ms</span>
                        <i></i>
                    </li>
                    <li>
                        <span>删除</span>
                        <span id="deleteTj">4 ms</span>
                    </li>
                </ul>
                <img class="t_r_line" src="images/right_line.png" alt="">
            </div>
            <div class="t_top2_box">
                <img class="t_l_line" src="images/left_line.png" alt="">
                <div class="t_mbox2">
                    <span style="color: #00b3ac; float: left; margin-left: 13%;">已运行：</span>
                    <span id="runTimeTj" style="float: left; margin-left: 5%;"></span>
                </div>
                <img class="t_r_line" src="images/right_line.png" alt="">
            </div>
            <div class="t_bottom_box"><!-- 动态图显示 -->
                <img class="t_l_line" src="images/left_line.png" alt="">
                <div class="chart" id="taskSize1" style="width: 100%; height:300px;"></div>

                <!-- 按钮 -->
                <button id="toggleButton">显示历史</button>
                <div class="chart-container" id="chartContainer">


                    <div class="chart" id="taskSize2" style="width: 100%; height:300px;"></div>
                </div>
                <img class="t_r_line" src="images/right_line.png" alt="">
            </div>
        </div>
    </div>
    <div class="t_table_box">
        <img class="t_l_line" src="images/left_line.png" alt="">
        <input type="text" id="searchText" value="" placeholder="输入内容筛选" />
        <table class="commonTable">
            <thead>
                <td title="序号" colspan="8">no monitor data</td>
            </thead>
        </table>
        <img class="t_r_line" src="images/right_line.png" alt="">
    </div>
    <script src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/echarts-all.js"></script>
    <script type="text/javascript" src="js/jquery.count.min.js"></script>
    <script type="text/javascript" src="js/monitor.js"></script>
    <div id="dataContainer"></div>
    <script>
        let dataArray = []; // 创建一个空数组来存储从服务器获取的数据
        // 使用 fetch() 方法从服务器获取数据
        fetch('http://localhost:40000/lastdata') // 修改为你的服务器地址和端口
            .then(response => response.json()) // 将响应解析为 JSON 格式
            .then(data => {
                // 在页面上显示获取的数据
                const dataContainer = document.getElementById('dataContainer');
                dataContainer.textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => console.error('Error fetching data:', error));
    </script>
    <script>
        // 获取按钮和图表容器元素
        const toggleButton = document.getElementById('toggleButton');
        const chartContainer = document.getElementById('chartContainer');

        // 初始状态为隐藏
        let chartVisible = false;
        chartContainer.style.display = 'none';

        // 按钮点击事件处理函数
        toggleButton.addEventListener('click', function () {
            // 如果图表可见，隐藏图表并更新按钮文本
            if (chartVisible) {
                chartContainer.style.display = 'none';
                toggleButton.textContent = 'Show Chart';
            } else { // 如果图表隐藏，显示图表并更新按钮文本
                chartContainer.style.display = 'block';
                toggleButton.textContent = 'Hide Chart';

            }
            // 更新图表可见状态
            chartVisible = !chartVisible;
        });


    </script>
</body>

</html>